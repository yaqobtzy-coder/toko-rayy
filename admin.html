<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>RAYY STORE | TITAN ADMIN PANEL v10.0</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #38bdf8;
            --primary-glow: rgba(56, 189, 248, 0.4);
            --bg: #030712;
            --card: #0f172a;
            --dark: #020617;
            --accent: #1e293b;
            --text: #f8fafc;
            --text-dim: #94a3b8;
            --green: #10b981;
            --red: #ef4444;
            --gold: #f59e0b;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; outline: none; font-family: 'Plus Jakarta Sans', sans-serif; }
        body { background: var(--bg); color: var(--text); min-height: 100vh; overflow-x: hidden; }

        /* --- ADVANCED BACKGROUND --- */
        .bg-glow { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; background: radial-gradient(circle at 50% -20%, #1e293b 0%, #030712 80%); }
        .grid-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; background-image: linear-gradient(rgba(56, 189, 248, 0.03) 1px, transparent 1px), linear-gradient(90deg, rgba(56, 189, 248, 0.03) 1px, transparent 1px); background-size: 30px 30px; }

        /* --- AUTHENTICATION (DEWA STYLE) --- */
        #authSection { position: fixed; inset: 0; background: var(--bg); z-index: 10000; display: flex; align-items: center; justify-content: center; padding: 20px; }
        .auth-box { width: 100%; max-width: 420px; background: var(--card); border-radius: 40px; padding: 50px 40px; border: 1px solid rgba(255,255,255,0.05); box-shadow: 0 40px 100px rgba(0,0,0,0.8); text-align: center; position: relative; overflow: hidden; }
        .auth-box::before { content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 5px; background: linear-gradient(90deg, transparent, var(--primary), transparent); }
        .auth-box h1 { font-size: 2.2rem; font-weight: 800; letter-spacing: -1px; margin-bottom: 10px; }
        .auth-box p { color: var(--text-dim); font-size: 0.8rem; margin-bottom: 40px; letter-spacing: 2px; }

        .input-wrap { position: relative; margin-bottom: 20px; }
        .input-wrap input { width: 100%; padding: 20px 25px; background: var(--dark); border: 2px solid var(--accent); border-radius: 20px; color: #fff; font-size: 1rem; transition: 0.4s; }
        .input-wrap input:focus { border-color: var(--primary); box-shadow: 0 0 20px rgba(56,189,248,0.1); transform: translateY(-2px); }

        .btn-auth { width: 100%; padding: 22px; background: var(--primary); color: #000; border: none; border-radius: 20px; font-weight: 800; cursor: pointer; text-transform: uppercase; letter-spacing: 2px; transition: 0.3s; box-shadow: 0 10px 30px var(--primary-glow); }
        .btn-auth:hover { transform: scale(1.02); filter: brightness(1.1); }

        /* --- MAIN DASHBOARD --- */
        .container { width: 100%; max-width: 1200px; margin: 0 auto; padding: 40px 20px; display: none; }
        
        /* Stats Grid */
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 40px; }
        .stat-card { background: var(--card); padding: 30px; border-radius: 30px; border: 1px solid rgba(255,255,255,0.05); position: relative; }
        .stat-card h4 { font-size: 0.7rem; color: var(--text-dim); text-transform: uppercase; letter-spacing: 2px; margin-bottom: 10px; }
        .stat-card .val { font-size: 1.8rem; font-weight: 800; color: var(--primary); }

        /* Transaction List */
        .section-title { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; }
        .section-title h2 { font-size: 1.5rem; font-weight: 800; }
        
        .trx-container { display: grid; gap: 15px; }
        .trx-item { background: var(--card); padding: 25px; border-radius: 25px; border: 1px solid rgba(255,255,255,0.05); display: flex; align-items: center; justify-content: space-between; transition: 0.3s; animation: reveal 0.5s ease forwards; }
        @keyframes reveal { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .trx-item:hover { background: var(--accent); border-color: var(--primary); }

        .info-main h3 { font-size: 1.1rem; font-weight: 700; margin-bottom: 5px; }
        .info-main p { font-size: 0.75rem; color: var(--text-dim); font-family: 'JetBrains Mono'; }
        
        .price-tag { font-size: 1.2rem; font-weight: 800; color: var(--primary); margin: 0 20px; }
        
        .status-pill { padding: 8px 15px; border-radius: 12px; font-size: 0.65rem; font-weight: 800; text-transform: uppercase; }
        .status-pending { background: rgba(245, 158, 11, 0.1); color: var(--gold); }
        .status-success { background: rgba(16, 185, 129, 0.1); color: var(--green); }

        .btn-acc { background: var(--green); color: #fff; border: none; padding: 12px 25px; border-radius: 15px; font-weight: 700; cursor: pointer; transition: 0.3s; }
        .btn-acc:hover { transform: translateY(-3px); box-shadow: 0 10px 20px rgba(16, 185, 129, 0.3); }

        /* Toast */
        #notification { position: fixed; bottom: -100px; right: 30px; background: var(--primary); color: #000; padding: 20px 40px; border-radius: 20px; font-weight: 800; transition: 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275); z-index: 99999; }
        #notification.active { bottom: 30px; }

        @media (max-width: 768px) {
            .trx-item { flex-direction: column; text-align: center; gap: 15px; }
            .btn-acc { width: 100%; }
        }
    </style>
</head>
<body>

    <div class="bg-glow"></div>
    <div class="grid-overlay"></div>
    <div id="notification">ORDER MASUK!</div>

    <div id="authSection">
        <div class="auth-box">
            <h1>RAYY <span style="color:var(--primary)">ADMIN</span></h1>
            <p>QUANTUM ACCESS v10.0</p>
            <div class="input-wrap">
                <input type="text" id="user" placeholder="Admin Username">
            </div>
            <div class="input-wrap">
                <input type="password" id="pass" placeholder="Master Password">
            </div>
            <button class="btn-auth" onclick="verifyAdmin()">Initialize Access</button>
        </div>
    </div>

    <div class="container" id="dashboard">
        <header style="margin-bottom: 50px; display: flex; justify-content: space-between; align-items: flex-end;">
            <div>
                <p style="color:var(--primary); font-size: 0.7rem; letter-spacing: 5px; font-weight: 800;">COMMAND CENTER</p>
                <h1 style="font-size: 2.5rem; font-weight: 800;">DASHBOARD</h1>
            </div>
            <div id="adminTag" style="font-size: 0.7rem; background: var(--accent); padding: 10px 20px; border-radius: 50px; border: 1px solid rgba(255,255,255,0.1);">
                CONNECTED AS: <span style="color:var(--primary); font-weight: 800;">-</span>
            </div>
        </header>

        <div class="stats-grid">
            <div class="stat-card">
                <h4>Total Revenue</h4>
                <div class="val" id="statRevenue">Rp 0</div>
            </div>
            <div class="stat-card">
                <h4>Success Orders</h4>
                <div class="val" id="statSuccess">0</div>
            </div>
            <div class="stat-card">
                <h4>Pending Tasks</h4>
                <div class="val" id="statPending" style="color:var(--gold)">0</div>
            </div>
        </div>

        <div class="section-title">
            <h2>Live Transactions</h2>
            <div style="font-size: 0.6rem; color: var(--text-dim);">AUTO-SYNC: ON</div>
        </div>

        <div class="trx-container" id="trxList">
            </div>
    </div>

    <audio id="notifSound" src="https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3"></audio>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, onValue, update, push } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = { databaseURL: "https://rayy-all-web-default-rtdb.asia-southeast1.firebasedatabase.app/" };
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        let currentAdmin = "";

        // --- AUTH LOGIC ---
        window.verifyAdmin = function() {
            const u = document.getElementById('user').value;
            const p = document.getElementById('pass').value;

            onValue(ref(db, 'sys_extra_admins/' + u), (snap) => {
                const data = snap.val();
                if(data && data.pass === p) {
                    currentAdmin = u;
                    document.getElementById('authSection').style.opacity = '0';
                    setTimeout(() => {
                        document.getElementById('authSection').style.display = 'none';
                        document.getElementById('dashboard').style.display = 'block';
                        document.getElementById('adminTag').querySelector('span').innerText = u.toUpperCase();
                        
                        // Device Fingerprint Logging
                        push(ref(db, 'system_logs'), {
                            user: u,
                            deviceId: "DV-" + btoa(navigator.userAgent).substring(5, 15),
                            time: new Date().toLocaleTimeString(),
                            action: "Admin Level Access"
                        });

                        initDashboard();
                    }, 500);
                } else { alert("ACCESS DENIED: MALICIOUS ATTEMPT DETECTED."); }
            }, { onlyOnce: true });
        };

        // --- CORE SYSTEM ---
        function initDashboard() {
            onValue(ref(db, 'transactions'), (snap) => {
                const list = document.getElementById('trxList');
                list.innerHTML = "";
                const data = snap.val();
                
                let revenue = 0;
                let successCount = 0;
                let pendingCount = 0;

                if(data) {
                    document.getElementById('notifSound').play();
                    showNotif();
                    
                    Object.keys(data).reverse().forEach(id => {
                        const tr = data[id];
                        if(tr.status === "Success") {
                            revenue += Number(tr.jumlah);
                            successCount++;
                        } else {
                            pendingCount++;
                        }

                        const item = document.createElement('div');
                        item.className = 'trx-item';
                        item.innerHTML = `
                            <div class="info-main">
                                <span class="status-pill ${tr.status === 'Pending' ? 'status-pending' : 'status-success'}">${tr.status}</span>
                                <h3 style="margin-top:10px;">${tr.nama}</h3>
                                <p>ID: ${id}</p>
                                <p>TIME: ${tr.waktu}</p>
                            </div>
                            <div class="price-tag">Rp ${Number(tr.jumlah).toLocaleString()}</div>
                            ${tr.status === 'Pending' ? 
                                `<button class="btn-acc" onclick="approveOrder('${id}')">APPROVE</button>` : 
                                `<div style="font-size:0.6rem; text-align:right;">VERIFIED BY:<br><b style="color:var(--green)">${tr.processedBy || 'MASTER'}</b></div>`
                            }
                        `;
                        list.appendChild(item);
                    });
                }
                
                // Update Stats
                document.getElementById('statRevenue').innerText = "Rp " + revenue.toLocaleString();
                document.getElementById('statSuccess').innerText = successCount;
                document.getElementById('statPending').innerText = pendingCount;
            });
        }

        window.approveOrder = (id) => {
            update(ref(db, 'transactions/' + id), {
                status: "Success",
                processedBy: currentAdmin
            });
        };

        function showNotif() {
            const n = document.getElementById('notification');
            n.classList.add('active');
            setTimeout(() => n.classList.remove('active'), 3000);
        }
    </script>
</body>
</html>
